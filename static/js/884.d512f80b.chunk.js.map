{"version":3,"file":"static/js/884.d512f80b.chunk.js","mappings":"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","sources":["createVideoProcessor/VideoProcessors/MediaPipe/drawImageMask.ts","utils/createFPSCounter.ts","createVideoProcessor/VideoProcessors/MediaPipeOptimized/index.ts","utils/canvas.ts","utils/createFpsMeter.ts","utils/mediaStreamToVideo.ts","../../../../node_modules/request-animation-runner/src/requestTimeout.ts","../../../../node_modules/request-animation-runner/src/createRunner.ts","../../../../node_modules/request-animation-runner/src/index.ts","../node_modules/@mediapipe/camera_utils/camera_utils.js"],"sourcesContent":["import { getContext, drawWithCompositing } from '../../../utils/canvas';\nimport type { TCanvas } from '../../../utils/canvas';\n\nconst drawImageMask = ({\n  videoSource,\n  canvas,\n  imageMask,\n  personMask,\n  edgeBlurAmount,\n}: {\n  videoSource: HTMLVideoElement;\n  canvas: TCanvas;\n  imageMask: HTMLImageElement;\n  personMask?: ImageBitmap;\n  edgeBlurAmount: number;\n}) => {\n  const { width, height } = videoSource;\n  const context = getContext(canvas);\n\n  if (!personMask) {\n    context.drawImage(videoSource, 0, 0);\n\n    return;\n  }\n\n  context.save();\n\n  // render original image\n  context.drawImage(videoSource, 0, 0);\n\n  if (edgeBlurAmount > 0) {\n    context.filter = `blur(${edgeBlurAmount}px)`;\n  }\n\n  drawWithCompositing(context, personMask, 'destination-in', width, height);\n  context.filter = 'none';\n\n  drawWithCompositing(context, imageMask, 'destination-over', width, height);\n\n  context.restore();\n};\n\nexport default drawImageMask;\n","const createFPSCounter = () => {\n  const fpsCounter = {\n    sampleSize: 60,\n    value: 0,\n    _sample_: [] as number[],\n    _index_: 0,\n    _lastTick_: 0,\n    tick() {\n      // if is first tick, just set tick timestamp and return\n      if (!this._lastTick_) {\n        this._lastTick_ = performance.now();\n\n        return 0;\n      }\n\n      // calculate necessary values to obtain current tick FPS\n      const now = performance.now();\n      const delta = (now - this._lastTick_) / 1000;\n      const fps = 1 / delta;\n\n      // add to fps samples, current tick fps value\n      this._sample_[this._index_] = Math.round(fps);\n\n      // iterate samples to obtain the average\n      let average = 0;\n\n      for (let i = 0; i < this._sample_.length; i++) {\n        average += this._sample_[i];\n      }\n\n      average = Math.round(average / this._sample_.length);\n\n      // set new FPS\n      this.value = average;\n      // store current timestamp\n      this._lastTick_ = now;\n      // increase sample index counter, and reset it\n      // to 0 if exceded maximum sampleSize limit\n      this._index_ += 1;\n\n      if (this._index_ === this.sampleSize) this._index_ = 0;\n\n      return this.value;\n    },\n  };\n\n  return fpsCounter;\n};\n\nexport default createFPSCounter;\n","import AnimationRequest from 'request-animation-runner';\nimport { Camera } from '@mediapipe/camera_utils';\nimport { SelfieSegmentation } from '@mediapipe/selfie_segmentation';\nimport type { ResultsListener } from '@mediapipe/selfie_segmentation';\nimport type { TResolveProcessVideo, TModelSelection } from '../../../typings';\nimport createFpsMeter from '../../../utils/createFpsMeter';\nimport createFPSCounter from '../../../utils/createFPSCounter';\nimport mediaStreamToVideo from '../../../utils/mediaStreamToVideo';\nimport { createCanvas } from '../../../utils/canvas';\nimport drawImageMask from '../MediaPipe/drawImageMask';\n\nconst resolveProcessVideoMediaPipeOptimized: TResolveProcessVideo = ({\n  imageBitmapMask360p,\n  imageBitmapMask720p,\n  imageBitmapMask1080p,\n}) => {\n  const selfieSegmentation = new SelfieSegmentation({\n    locateFile: (file) => {\n      return `https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${file}`;\n    },\n  });\n  const fpsMeter = createFpsMeter();\n  const fpsCounter = createFPSCounter();\n  const animationRequest = new AnimationRequest();\n  let videoSource: HTMLVideoElement;\n  let canvasTarget: HTMLCanvasElement;\n\n  const createVideo = (mediaStream: MediaStream) => {\n    return mediaStreamToVideo(mediaStream).then((video) => {\n      videoSource = video;\n\n      return videoSource;\n    });\n  };\n  const isInProgressVideoProcessing = false;\n  const checkEndProgressVideoProcessing = () => {\n    return new Promise<void>((resolve) => {\n      const check = () => {\n        if (isInProgressVideoProcessing === false) {\n          resolve();\n        } else {\n          setTimeout(check, 100);\n        }\n      };\n\n      check();\n    });\n  };\n  const startVideoProcessing = ({\n    modelSelection,\n    edgeBlurAmount,\n  }: {\n    modelSelection: TModelSelection;\n    edgeBlurAmount: number;\n  }) => {\n    const { width, height } = videoSource;\n\n    let imageBitmapMask: HTMLImageElement;\n\n    fpsMeter.init();\n\n    // eslint-disable-next-line default-case\n    switch (width) {\n      case 640:\n        imageBitmapMask = imageBitmapMask360p;\n        break;\n      case 1280:\n        imageBitmapMask = imageBitmapMask720p;\n        break;\n      case 1920:\n        imageBitmapMask = imageBitmapMask1080p;\n        break;\n    }\n\n    let personMask: ImageBitmap | undefined;\n\n    const targetVideoFrame = () => {\n      drawImageMask({\n        edgeBlurAmount,\n        personMask,\n        videoSource,\n        imageMask: imageBitmapMask,\n        canvas: canvasTarget,\n      });\n      fpsMeter.end();\n      fpsCounter.tick();\n    };\n\n    const onResults: ResultsListener = (results) => {\n      personMask = results.segmentationMask as ImageBitmap;\n      targetVideoFrame();\n    };\n\n    const GENERAL = 0;\n    const LANDSCAPE = 1;\n\n    selfieSegmentation.setOptions({\n      modelSelection: modelSelection === 'general' ? GENERAL : LANDSCAPE,\n    });\n    selfieSegmentation.onResults(onResults);\n\n    const camera = new Camera(videoSource, {\n      onFrame: async () => {\n        fpsMeter.begin();\n        await selfieSegmentation.send({ image: videoSource });\n      },\n      width,\n      height,\n    });\n\n    camera.start();\n\n    animationRequest.activate();\n    animationRequest.run(() => {\n      if (fpsCounter.value < 60 && personMask) {\n        // targetVideoFrame();\n        console.log(\n          'ðŸš€ ~ file: index.ts ~ line 117 ~ animationRequest.run ~ targetVideoFrame',\n          fpsCounter.value\n        );\n      }\n    }, 60);\n  };\n\n  const start = ({\n    mediaStream,\n    modelSelection,\n    edgeBlurAmount,\n  }: {\n    mediaStream: MediaStream;\n    modelSelection: TModelSelection;\n    edgeBlurAmount: number;\n  }) => {\n    return createVideo(mediaStream).then(() => {\n      const { width, height } = videoSource;\n\n      canvasTarget = createCanvas(width, height);\n\n      startVideoProcessing({ modelSelection, edgeBlurAmount });\n\n      const mediaStreamOutput = canvasTarget.captureStream();\n\n      return mediaStreamOutput;\n    });\n  };\n  const stopVideoProcessing = () => {\n    animationRequest.deactivate();\n    fpsMeter.reset();\n\n    return checkEndProgressVideoProcessing();\n\n    // return selfieSegmentation.close().then(checkEndProgressVideoProcessing);\n  };\n  const stop = () => {\n    return stopVideoProcessing().then(() => {\n      if (videoSource) {\n        videoSource.srcObject = null;\n      }\n    });\n  };\n\n  const changeParams = ({\n    modelSelection,\n    edgeBlurAmount,\n  }: {\n    modelSelection: TModelSelection;\n    edgeBlurAmount: number;\n  }) => {\n    return stopVideoProcessing()\n      .then(() => {})\n      .then(() => {\n        return startVideoProcessing({ modelSelection, edgeBlurAmount });\n      });\n  };\n  const restart = ({\n    mediaStream,\n    modelSelection,\n    edgeBlurAmount,\n  }: {\n    mediaStream: MediaStream;\n    modelSelection: TModelSelection;\n    edgeBlurAmount: number;\n  }) => {\n    return stop().then(() => {\n      return start({\n        mediaStream,\n        modelSelection,\n        edgeBlurAmount,\n      });\n    });\n  };\n\n  return { start, restart, changeParams, stop };\n};\nexport default resolveProcessVideoMediaPipeOptimized;\n","export type TCanvas = HTMLCanvasElement | OffscreenCanvas;\n\nexport const createCanvas = (width: number, height: number): HTMLCanvasElement => {\n  const canvas = document.createElement('canvas');\n\n  canvas.width = width;\n  canvas.height = height;\n\n  return canvas;\n};\n\nexport const getContext = <T = CanvasRenderingContext2D>(\n  canvas: TCanvas,\n  {\n    type = '2d',\n    imageSmoothingQuality,\n    globalCompositeOperation,\n    alpha = false,\n  }: {\n    type?: '2d';\n    imageSmoothingQuality?: ImageSmoothingQuality;\n    globalCompositeOperation?: GlobalCompositeOperation;\n    alpha?: boolean;\n  } = {}\n): T => {\n  const context = canvas.getContext(type, {\n    alpha,\n    desynchronized: true,\n    willReadFrequently: true,\n  }) as CanvasRenderingContext2D;\n\n  if (imageSmoothingQuality) {\n    context.imageSmoothingEnabled = true;\n    context.imageSmoothingQuality = imageSmoothingQuality;\n  }\n\n  if (globalCompositeOperation) {\n    context.globalCompositeOperation = globalCompositeOperation;\n  }\n\n  const contextReturned = context as unknown as T;\n\n  return contextReturned;\n};\n\nexport const createOffScreenCanvas = (width: number, height: number): OffscreenCanvas => {\n  const offScreenCanvas = new OffscreenCanvas(width, height);\n\n  return offScreenCanvas;\n};\n\nexport const fill = (\n  canvas: TCanvas,\n  {\n    x = 0,\n    y = 0,\n    width,\n    height,\n    color = '#202020',\n  }: {\n    x?: number;\n    y?: number;\n    width: number;\n    height: number;\n    color?: string;\n  }\n) => {\n  const context = getContext(canvas);\n\n  context.fillStyle = color;\n  context.fillRect(x, y, width, height);\n};\n\nconst getImageSizes = (image: CanvasImageSource | ImageBitmap) => {\n  const { height, width } = image as { width: number; height: number };\n\n  return { height, width };\n};\n\nexport const renderImageDataToCanvas = (image: ImageData, canvas) => {\n  const context = getContext(canvas);\n\n  context.putImageData(image, 0, 0);\n};\n\nexport const renderImageToCanvas = (\n  image: CanvasImageSource,\n  canvas: TCanvas,\n  {\n    x = 0,\n    y = 0,\n    width,\n    height,\n    imageSmoothingQuality,\n    alpha,\n    globalCompositeOperation,\n  }: {\n    x?: number;\n    y?: number;\n    width?: number;\n    height?: number;\n    imageSmoothingQuality?: ImageSmoothingQuality;\n    alpha?: boolean;\n    globalCompositeOperation?: GlobalCompositeOperation;\n  } = {}\n) => {\n  const imageSizes = getImageSizes(image);\n  const targetWidth = width || imageSizes.width;\n  const targetHeight = height || imageSizes.height;\n  const context = getContext(canvas, { imageSmoothingQuality, alpha, globalCompositeOperation });\n\n  context.drawImage(image, x, y, targetWidth, targetHeight);\n};\n\nconst drawAndBlurImageOnCanvas = (image, blurAmount, canvas) => {\n  const { height, width } = image;\n  const context = getContext(canvas);\n\n  context.clearRect(0, 0, width, height);\n  context.save();\n\n  context.filter = `blur(${blurAmount}px)`;\n  context.drawImage(image, 0, 0, width, height);\n\n  context.restore();\n};\n\nexport const drawAndBlurImageOnOffScreenCanvas = ({\n  canvas,\n  image,\n  blurAmount,\n}: {\n  canvas: OffscreenCanvas;\n  image: CanvasImageSource;\n  blurAmount: number;\n}) => {\n  if (blurAmount === 0) {\n    renderImageToCanvas(image, canvas);\n  } else {\n    drawAndBlurImageOnCanvas(image, blurAmount, canvas);\n  }\n};\n\nexport const drawWithCompositing = (\n  context: CanvasRenderingContext2D,\n  image: CanvasImageSource,\n  compositeOperation,\n  desiredWidth,\n  desiredHeight\n) => {\n  context.globalCompositeOperation = compositeOperation;\n\n  const { width, height } = image;\n\n  context.drawImage(\n    image,\n    0,\n    0,\n    // @ts-ignore\n    width,\n    height,\n    0,\n    0,\n    desiredWidth,\n    desiredHeight\n  );\n};\n\nexport const imageBitmapToImageData = (canvas, imageBitmap, desiredWidth, desiredHeight) => {\n  const { width, height } = imageBitmap;\n  const context = getContext(canvas);\n\n  context.drawImage(imageBitmap, 0, 0, width, height, 0, 0, desiredWidth, desiredHeight);\n\n  const imageData = context.getImageData(0, 0, desiredWidth, desiredHeight);\n\n  return imageData;\n};\n\nexport const imageToImageBitmap = ({\n  canvas,\n  image,\n}: {\n  canvas: OffscreenCanvas;\n  image: CanvasImageSource;\n}) => {\n  renderImageToCanvas(image, canvas);\n\n  return canvas.transferToImageBitmap();\n};\n","import Stats from 'stats-js';\n\nconst createFpsMeter = () => {\n  let stats;\n  let isBegined = false;\n  let isEnded = true;\n  const init = () => {\n    isBegined = false;\n    isEnded = true;\n    stats = new Stats();\n    stats.showPanel(0);\n\n    document.body.appendChild(stats.dom);\n  };\n  const begin = () => {\n    if (stats && isEnded && !isBegined) {\n      isEnded = false;\n      isBegined = true;\n      stats.begin();\n    }\n  };\n  const end = () => {\n    if (stats && isBegined && !isEnded) {\n      isEnded = true;\n      isBegined = false;\n      stats.end();\n    }\n  };\n  const reset = () => {\n    document.body.removeChild(stats.dom);\n    stats = undefined;\n  };\n\n  return { init, begin, end, reset };\n};\n\nexport default createFpsMeter;\n","const mediaStreamToVideo = (mediaStream: MediaStream): Promise<HTMLVideoElement> => {\n  const videoElement = document.createElement('video');\n\n  videoElement.srcObject = mediaStream;\n\n  return new Promise((resolve) => {\n    videoElement.onloadedmetadata = () => {\n      videoElement.width = videoElement.videoWidth;\n      videoElement.height = videoElement.videoHeight;\n      videoElement.play();\n      resolve(videoElement);\n    };\n  });\n};\n\nexport default mediaStreamToVideo;\n","let last = 0;\nlet id = 0;\nconst queue: {\n  handle: number;\n  callback: FrameRequestCallback;\n  cancelled: boolean;\n}[] = [];\nconst frameDuration = 1000 / 60;\n\nexport const request = (callback: FrameRequestCallback) => {\n  if (queue.length === 0) {\n    const time = performance.now();\n    const next = Math.max(0, frameDuration - (time - last));\n\n    last = next + time;\n    setTimeout(() => {\n      const cp = queue.slice(0);\n\n      // Clear queue here to prevent\n      // callbacks from appending listeners\n      // to the current frame's queue\n      queue.length = 0;\n\n      for (let i = 0; i < cp.length; i++) {\n        if (!cp[i].cancelled) {\n          try {\n            cp[i].callback(last);\n          } catch (e) {\n            setTimeout(() => {\n              throw e;\n            }, 0);\n          }\n        }\n      }\n    }, Math.round(next));\n  }\n\n  id += 1;\n  queue.push({\n    handle: id,\n    cancelled: false,\n    callback,\n  });\n\n  return id;\n};\n\nexport const cancelRequest = (handle: number) => {\n  for (let i = 0; i < queue.length; i++) {\n    if (queue[i].handle === handle) {\n      queue[i].cancelled = true;\n    }\n  }\n};\n","// @ts-ignore\nimport { request, cancelRequest } from './requestTimeout';\n\nlet isAvailableAnimation = !document || !document.hidden;\n\nconst createRunner = (backgroundThrottling: boolean = true) => {\n  const hasAvailableAnimation = () => {\n    return backgroundThrottling || isAvailableAnimation;\n  };\n  const restartHandlers = new Map<number, () => void>();\n  const whenRestarted = (handle: number, callback: () => void) => {\n    restartHandlers.set(handle, callback);\n  };\n  const offRestart = (handle: number) => {\n    restartHandlers.delete(handle);\n  };\n\n  const requestAnimationFrame = (callback: FrameRequestCallback): number => {\n    if (hasAvailableAnimation()) {\n      return window.requestAnimationFrame(callback);\n    }\n\n    return request(callback);\n  };\n\n  const cancelAnimationFrame = (handle: number): void => {\n    window.cancelAnimationFrame(handle);\n    cancelRequest(handle);\n  };\n\n  document.addEventListener('visibilitychange', () => {\n    isAvailableAnimation = !document || !document.hidden;\n\n    if (!hasAvailableAnimation()) {\n      restartHandlers.forEach((callback, key) => {\n        callback();\n        offRestart(key);\n      });\n    }\n  });\n\n  return { requestAnimationFrame, cancelAnimationFrame, whenRestarted, offRestart };\n};\n\nexport default createRunner;\n","import createRunner from './createRunner';\n\nexport default class RequestAnimation {\n  private requestID?: number;\n\n  private active = true;\n\n  private runner: ReturnType<typeof createRunner>;\n\n  constructor(\n    { backgroundThrottling }: { backgroundThrottling?: boolean } = {\n      backgroundThrottling: true,\n    }\n  ) {\n    this.runner = createRunner(backgroundThrottling);\n  }\n\n  /**\n   * Resolve the animation loop calculates time elapsed since the last loop\n   * and only draws if your specified fps interval is achieved\n   *\n   * @param {function} animationFunc - Function for animation\n   * @param {string}   fps           - Frames per Second\n   *\n   * @returns {undefined}\n   */\n  run(animationFunc: FrameRequestCallback, fps = 60) {\n    const fpsInterval = 1000 / fps;\n\n    let delta = 0; // 0 for run for first, set Date.now() if no needs first run\n\n    /**\n     * Animate loop\n     *\n     * @param {number} timestamp - DOMHighResTimeStamp similar to the one returned by performance.now()\n     * indicating the point in time when requestAnimationFrame() starts to execute callback functions.\n     *\n     * @returns {undefined}\n     */\n    const animateLoop = (timestamp: number) => {\n      this.request(animateLoop);\n\n      // calc elapsed time since last loop\n      const elapsed = timestamp - delta;\n\n      // if enough time has elapsed, draw the next frame\n\n      if (elapsed > fpsInterval) {\n        // Get ready for next frame by setting delta=timestamp, but also adjust for your\n        // specified fpsInterval not being a multiple of RAF's interval (16.7ms)\n        delta = timestamp - (elapsed % fpsInterval);\n\n        animationFunc(timestamp);\n      }\n    };\n\n    this.cancelRequest();\n    this.request(animateLoop);\n  }\n\n  /**\n   * Resolve the animation loop calculates time elapsed since the last loop\n   * and only draws if your specified fps interval is achieved\n   *\n   * @param {function} animationFunc - Function for animation\n   * @param {string}   fps           - Frames per Second\n   *\n   * @returns {undefined}\n   */\n  async runAsync(animationFunc: FrameRequestCallback, fps = 60) {\n    const fpsInterval = 1000 / fps;\n\n    let delta = 0; // 0 for run for first, set Date.now() if no needs first run\n\n    /**\n     * Animate loop\n     *\n     * @param {number} timestamp - DOMHighResTimeStamp similar to the one returned by performance.now()\n     * indicating the point in time when requestAnimationFrame() starts to execute callback functions.\n     *\n     * @returns {undefined}\n     */\n    const animateLoop = async (timestamp: number) => {\n      // calc elapsed time since last loop\n      const elapsed = timestamp - delta;\n\n      // if enough time has elapsed, draw the next frame\n\n      if (elapsed > fpsInterval) {\n        // Get ready for next frame by setting delta=timestamp, but also adjust for your\n        // specified fpsInterval not being a multiple of RAF's interval (16.7ms)\n        delta = timestamp - (elapsed % fpsInterval);\n\n        await animationFunc(timestamp);\n      }\n\n      this.request(animateLoop);\n    };\n\n    this.cancelRequest();\n    this.request(animateLoop);\n  }\n\n  /**\n   * Request single call\n   *\n   * @param {function} animationFunc - Function for animation\n   *\n   * @returns {undefined}\n   */\n  request(animationFunc: FrameRequestCallback) {\n    if (this.requestID) {\n      this.runner.offRestart(this.requestID);\n    }\n\n    if (this.active) {\n      this.requestID = this.runner.requestAnimationFrame(animationFunc);\n\n      this.runner.whenRestarted(this.requestID, () => {\n        this.cancelRequest();\n        this.requestID = this.runner.requestAnimationFrame(animationFunc);\n      });\n    }\n  }\n\n  /**\n   * cancelRequest\n   *\n   * @returns {undefined}\n   */\n  cancelRequest() {\n    if (this.requestID) {\n      this.runner.cancelAnimationFrame(this.requestID);\n      this.runner.offRestart(this.requestID);\n    }\n  }\n\n  /**\n   * activate\n   *\n   * @returns {undefined}\n   */\n  activate() {\n    this.cancelRequest();\n    this.active = true;\n  }\n\n  /**\n   * deactivate\n   *\n   * @returns {undefined}\n   */\n  deactivate() {\n    this.cancelRequest();\n    this.active = false;\n  }\n}\n","(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\n'use strict';function n(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var q=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){if(a==Array.prototype||a==Object.prototype)return a;a[b]=e.value;return a};\nfunction t(a){a=[\"object\"==typeof globalThis&&globalThis,a,\"object\"==typeof window&&window,\"object\"==typeof self&&self,\"object\"==typeof global&&global];for(var b=0;b<a.length;++b){var e=a[b];if(e&&e.Math==Math)return e}throw Error(\"Cannot find global object\");}var u=t(this);function v(a,b){if(b)a:{var e=u;a=a.split(\".\");for(var f=0;f<a.length-1;f++){var h=a[f];if(!(h in e))break a;e=e[h]}a=a[a.length-1];f=e[a];b=b(f);b!=f&&null!=b&&q(e,a,{configurable:!0,writable:!0,value:b})}}\nv(\"Symbol\",function(a){function b(l){if(this instanceof b)throw new TypeError(\"Symbol is not a constructor\");return new e(f+(l||\"\")+\"_\"+h++,l)}function e(l,c){this.g=l;q(this,\"description\",{configurable:!0,writable:!0,value:c})}if(a)return a;e.prototype.toString=function(){return this.g};var f=\"jscomp_symbol_\"+(1E9*Math.random()>>>0)+\"_\",h=0;return b});\nv(\"Symbol.iterator\",function(a){if(a)return a;a=Symbol(\"Symbol.iterator\");for(var b=\"Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array\".split(\" \"),e=0;e<b.length;e++){var f=u[b[e]];\"function\"===typeof f&&\"function\"!=typeof f.prototype[a]&&q(f.prototype,a,{configurable:!0,writable:!0,value:function(){return w(n(this))}})}return a});function w(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}\nfunction x(a){var b=\"undefined\"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:n(a)}}function y(){this.i=!1;this.g=null;this.o=void 0;this.j=1;this.m=0;this.h=null}function z(a){if(a.i)throw new TypeError(\"Generator is already running\");a.i=!0}y.prototype.l=function(a){this.o=a};function A(a,b){a.h={F:b,G:!0};a.j=a.m}y.prototype.return=function(a){this.h={return:a};this.j=this.m};function B(a){this.g=new y;this.h=a}\nfunction C(a,b){z(a.g);var e=a.g.g;if(e)return D(a,\"return\"in e?e[\"return\"]:function(f){return{value:f,done:!0}},b,a.g.return);a.g.return(b);return H(a)}function D(a,b,e,f){try{var h=b.call(a.g.g,e);if(!(h instanceof Object))throw new TypeError(\"Iterator result \"+h+\" is not an object\");if(!h.done)return a.g.i=!1,h;var l=h.value}catch(c){return a.g.g=null,A(a.g,c),H(a)}a.g.g=null;f.call(a.g,l);return H(a)}\nfunction H(a){for(;a.g.j;)try{var b=a.h(a.g);if(b)return a.g.i=!1,{value:b.value,done:!1}}catch(e){a.g.o=void 0,A(a.g,e)}a.g.i=!1;if(a.g.h){b=a.g.h;a.g.h=null;if(b.G)throw b.F;return{value:b.return,done:!0}}return{value:void 0,done:!0}}\nfunction I(a){this.next=function(b){z(a.g);a.g.g?b=D(a,a.g.g.next,b,a.g.l):(a.g.l(b),b=H(a));return b};this.throw=function(b){z(a.g);a.g.g?b=D(a,a.g.g[\"throw\"],b,a.g.l):(A(a.g,b),b=H(a));return b};this.return=function(b){return C(a,b)};this[Symbol.iterator]=function(){return this}}function J(a){function b(f){return a.next(f)}function e(f){return a.throw(f)}return new Promise(function(f,h){function l(c){c.done?f(c.value):Promise.resolve(c.value).then(b,e).then(l,h)}l(a.next())})}\nv(\"Promise\",function(a){function b(c){this.h=0;this.i=void 0;this.g=[];this.o=!1;var d=this.j();try{c(d.resolve,d.reject)}catch(g){d.reject(g)}}function e(){this.g=null}function f(c){return c instanceof b?c:new b(function(d){d(c)})}if(a)return a;e.prototype.h=function(c){if(null==this.g){this.g=[];var d=this;this.i(function(){d.l()})}this.g.push(c)};var h=u.setTimeout;e.prototype.i=function(c){h(c,0)};e.prototype.l=function(){for(;this.g&&this.g.length;){var c=this.g;this.g=[];for(var d=0;d<c.length;++d){var g=\nc[d];c[d]=null;try{g()}catch(k){this.j(k)}}}this.g=null};e.prototype.j=function(c){this.i(function(){throw c;})};b.prototype.j=function(){function c(k){return function(m){g||(g=!0,k.call(d,m))}}var d=this,g=!1;return{resolve:c(this.A),reject:c(this.l)}};b.prototype.A=function(c){if(c===this)this.l(new TypeError(\"A Promise cannot resolve to itself\"));else if(c instanceof b)this.C(c);else{a:switch(typeof c){case \"object\":var d=null!=c;break a;case \"function\":d=!0;break a;default:d=!1}d?this.v(c):this.m(c)}};\nb.prototype.v=function(c){var d=void 0;try{d=c.then}catch(g){this.l(g);return}\"function\"==typeof d?this.D(d,c):this.m(c)};b.prototype.l=function(c){this.u(2,c)};b.prototype.m=function(c){this.u(1,c)};b.prototype.u=function(c,d){if(0!=this.h)throw Error(\"Cannot settle(\"+c+\", \"+d+\"): Promise already settled in state\"+this.h);this.h=c;this.i=d;2===this.h&&this.B();this.H()};b.prototype.B=function(){var c=this;h(function(){if(c.I()){var d=u.console;\"undefined\"!==typeof d&&d.error(c.i)}},1)};b.prototype.I=\nfunction(){if(this.o)return!1;var c=u.CustomEvent,d=u.Event,g=u.dispatchEvent;if(\"undefined\"===typeof g)return!0;\"function\"===typeof c?c=new c(\"unhandledrejection\",{cancelable:!0}):\"function\"===typeof d?c=new d(\"unhandledrejection\",{cancelable:!0}):(c=u.document.createEvent(\"CustomEvent\"),c.initCustomEvent(\"unhandledrejection\",!1,!0,c));c.promise=this;c.reason=this.i;return g(c)};b.prototype.H=function(){if(null!=this.g){for(var c=0;c<this.g.length;++c)l.h(this.g[c]);this.g=null}};var l=new e;b.prototype.C=\nfunction(c){var d=this.j();c.s(d.resolve,d.reject)};b.prototype.D=function(c,d){var g=this.j();try{c.call(d,g.resolve,g.reject)}catch(k){g.reject(k)}};b.prototype.then=function(c,d){function g(p,r){return\"function\"==typeof p?function(E){try{k(p(E))}catch(F){m(F)}}:r}var k,m,G=new b(function(p,r){k=p;m=r});this.s(g(c,k),g(d,m));return G};b.prototype.catch=function(c){return this.then(void 0,c)};b.prototype.s=function(c,d){function g(){switch(k.h){case 1:c(k.i);break;case 2:d(k.i);break;default:throw Error(\"Unexpected state: \"+\nk.h);}}var k=this;null==this.g?l.h(g):this.g.push(g);this.o=!0};b.resolve=f;b.reject=function(c){return new b(function(d,g){g(c)})};b.race=function(c){return new b(function(d,g){for(var k=x(c),m=k.next();!m.done;m=k.next())f(m.value).s(d,g)})};b.all=function(c){var d=x(c),g=d.next();return g.done?f([]):new b(function(k,m){function G(E){return function(F){p[E]=F;r--;0==r&&k(p)}}var p=[],r=0;do p.push(void 0),r++,f(g.value).s(G(p.length-1),m),g=d.next();while(!g.done)})};return b});\nvar K=\"function\"==typeof Object.assign?Object.assign:function(a,b){for(var e=1;e<arguments.length;e++){var f=arguments[e];if(f)for(var h in f)Object.prototype.hasOwnProperty.call(f,h)&&(a[h]=f[h])}return a};v(\"Object.assign\",function(a){return a||K});var L=this||self;var M={facingMode:\"user\",width:640,height:480};function N(a,b){this.video=a;this.i=0;this.h=Object.assign(Object.assign({},M),b)}N.prototype.stop=function(){var a=this,b,e,f,h;return J(new I(new B(function(l){if(a.g){b=a.g.getTracks();e=x(b);for(f=e.next();!f.done;f=e.next())h=f.value,h.stop();a.g=void 0}l.j=0})))};\nN.prototype.start=function(){var a=this,b;return J(new I(new B(function(e){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert(\"No navigator.mediaDevices.getUserMedia exists.\");b=a.h;return e.return(navigator.mediaDevices.getUserMedia({video:{facingMode:b.facingMode,width:b.width,height:b.height}}).then(function(f){O(a,f)}).catch(function(f){var h=\"Failed to acquire camera feed: \"+f;console.error(h);alert(h);throw f;}))})))};\nfunction P(a){window.requestAnimationFrame(function(){Q(a)})}function O(a,b){a.g=b;a.video.srcObject=b;a.video.onloadedmetadata=function(){a.video.play();P(a)}}function Q(a){var b=null;a.video.paused||a.video.currentTime===a.i||(a.i=a.video.currentTime,b=a.h.onFrame());b?b.then(function(){P(a)}):P(a)}var R=[\"Camera\"],S=L;R[0]in S||\"undefined\"==typeof S.execScript||S.execScript(\"var \"+R[0]);\nfor(var T;R.length&&(T=R.shift());)R.length||void 0===N?S[T]&&S[T]!==Object.prototype[T]?S=S[T]:S=S[T]={}:S[T]=N;}).call(this);\n"],"names":["videoSource","canvas","imageMask","personMask","edgeBlurAmount","width","height","context","getContext","save","drawImage","filter","drawWithCompositing","restore","sampleSize","value","_sample_","_index_","_lastTick_","tick","this","performance","now","fps","Math","round","average","i","length","imageBitmapMask360p","imageBitmapMask720p","imageBitmapMask1080p","selfieSegmentation","SelfieSegmentation","locateFile","file","fpsMeter","createFpsMeter","fpsCounter","createFPSCounter","animationRequest","AnimationRequest","canvasTarget","startVideoProcessing","modelSelection","imageBitmapMask","init","setOptions","onResults","results","segmentationMask","drawImageMask","end","Camera","onFrame","async","begin","send","image","start","activate","run","console","log","mediaStream","mediaStreamToVideo","then","video","createVideo","createCanvas","captureStream","stopVideoProcessing","deactivate","reset","Promise","resolve","stop","srcObject","restart","changeParams","document","createElement","type","imageSmoothingQuality","globalCompositeOperation","alpha","desynchronized","willReadFrequently","imageSmoothingEnabled","createOffScreenCanvas","OffscreenCanvas","getImageSizes","renderImageDataToCanvas","putImageData","renderImageToCanvas","x","y","imageSizes","targetWidth","targetHeight","compositeOperation","desiredWidth","desiredHeight","imageToImageBitmap","transferToImageBitmap","stats","isBegined","isEnded","Stats","showPanel","body","appendChild","dom","removeChild","undefined","videoElement","onloadedmetadata","videoWidth","videoHeight","play","last","id","queue","isAvailableAnimation","hidden","offRestart","RequestAnimation","constructor","backgroundThrottling","runner","hasAvailableAnimation","restartHandlers","Map","handle","delete","addEventListener","forEach","callback","key","requestAnimationFrame","window","time","next","max","setTimeout","cp","slice","cancelled","e","push","cancelAnimationFrame","whenRestarted","set","createRunner","animationFunc","fpsInterval","delta","animateLoop","timestamp","request","elapsed","cancelRequest","runAsync","requestID","active","n","a","b","done","q","Object","defineProperties","defineProperty","Array","prototype","u","globalThis","self","global","Error","t","v","split","f","h","configurable","writable","w","Symbol","iterator","call","g","o","j","m","z","TypeError","A","F","G","B","D","l","c","H","return","I","throw","C","J","toString","random","d","reject","k","error","CustomEvent","Event","dispatchEvent","cancelable","createEvent","initCustomEvent","promise","reason","s","p","r","E","catch","race","all","K","assign","arguments","hasOwnProperty","L","M","facingMode","N","P","paused","currentTime","Q","getTracks","navigator","mediaDevices","getUserMedia","alert","O","T","R","S","execScript","shift"],"sourceRoot":""}